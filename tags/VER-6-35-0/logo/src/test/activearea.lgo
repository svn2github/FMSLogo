LOAD "testlib.lgo

TO ACTIVEAREATEST.SMOKETEST

   LOCALMAKE "oldactivearea ACTIVEAREA

   SETACTIVEAREA [0 100 200 300]
   SIMPLEREPORTTEST [ACTIVEAREA] [0 100 200 300]

   ; there is special code for 0.0 instead of 0
   SETACTIVEAREA [0.0 0.0 200 200]
   SIMPLEREPORTTEST [ACTIVEAREA] [0.0 0.0 200 200]

   SETACTIVEAREA [-100 -100 100 100]
   SIMPLEREPORTTEST [ACTIVEAREA] [-100 -100 100 100]

   ; there is special code for the "default" active area
   SETACTIVEAREA [-500 -500 500 500]
   SIMPLEREPORTTEST [ACTIVEAREA] [-500 -500 500 500]

   ; floating point values are accepted (and truncated)
   SETACTIVEAREA [-500.67 -500.43 500.00 500.9999]
   SIMPLEREPORTTEST [ACTIVEAREA] [-500 -500 500 500]

   ; undo side-effects
   SETACTIVEAREA :oldactivearea
END

TO ACTIVEAREATEST.BADINPUT

   LOCALMAKE "oldactivearea ACTIVEAREA

   ; Set to a very strange value to confirm that 
   ; these tests don't modify the active area
   SETACTIVEAREA [1 1 2 2]

   ; unexpected number of inputs
   RUNNOTENOUGHINPUTSTEST [(SETACTIVEAREA)                ]
   RUNTOOMANYINPUTSTEST   [(SETACTIVEAREA 0 0)            ]
   RUNTOOMANYINPUTSTEST   [(SETACTIVEAREA 0 0 50)         ]
   RUNTOOMANYINPUTSTEST   [(SETACTIVEAREA 0 0 50 50)      ]

   ; wrong number of inputs for list
   RUNDOESNTLIKEINPUTTEST [(SETACTIVEAREA [0])            ]
   RUNDOESNTLIKEINPUTTEST [(SETACTIVEAREA [0 0])          ]
   RUNDOESNTLIKEINPUTTEST [(SETACTIVEAREA [0 0 50])       ]
   RUNDOESNTLIKEINPUTTEST [(SETACTIVEAREA [0 0 50 50 50]) ]

   ; bad parameters
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA 0            ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA "|0,0,50,50| ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA {0      0    50     50}     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [zero   0    50     50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [[0]    0    50     50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [{0}    0    50     50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [-1e20  0    50     50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0     zero  50     50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0     [0]   50     50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0     {0}   50     50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0    -1e20  50     50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0      0    fifty  50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0      0    [50]   50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0      0    {50}   50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0      0    1e20   50]     ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0      0    50     fifty]  ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0      0    50     [50]]   ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0      0    50     {50}]   ]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0      0    50     1e20]   ]
       
   ; invalid ranges
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0     0    -50     50]]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0     0     50    -50]]
   RUNDOESNTLIKEINPUTTEST [SETACTIVEAREA [0     0      0      0]]

   RUNTOOMANYINPUTSTEST [(ACTIVEAREA  "toomany)]

   ; check that none of the bad input tests modified 
   ; the real active area
   SIMPLEREPORTTEST [ACTIVEAREA] [1 1 2 2]

   ; undo side-effects
   SETACTIVEAREA :oldactivearea
END

TO ACTIVEAREATEST

   ACTIVEAREATEST.SMOKETEST
   ACTIVEAREATEST.BADINPUT

END
