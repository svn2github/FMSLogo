LOAD "testlib.lgo

TO BITANDTEST.SMOKETEST

  SIMPLEREPORTTEST [(BITAND)]      -1

  SIMPLEREPORTTEST [(BITAND 123)]   123
  SIMPLEREPORTTEST [(BITAND -123)] -123

  SIMPLEREPORTTEST [(BITAND 5    2   )]   0
  SIMPLEREPORTTEST [(BITAND 5    1   )]   1
  SIMPLEREPORTTEST [(BITAND 0   -1   )]   0
  SIMPLEREPORTTEST [(BITAND 5   -1   )]   5
  SIMPLEREPORTTEST [(BITAND 5.0  1.0 )]   1

  SIMPLEREPORTTEST [(BITAND 6 2 10)]      2

END

TO BITANDTEST.BADINPUT

  ; first input is bad
  RUNBADINPUTTEST [(BITAND "word)]
  RUNBADINPUTTEST [(BITAND [123])]
  RUNBADINPUTTEST [(BITAND {123})]
  RUNBADINPUTTEST [(BITAND 12.30)]

  ; second input is bad
  RUNBADINPUTTEST [(BITAND 1 "word)]
  RUNBADINPUTTEST [(BITAND 1 [123])]
  RUNBADINPUTTEST [(BITAND 1 {123})]
  RUNBADINPUTTEST [(BITAND 1 12.30)]
END

TO BITORTEST.SMOKETEST

  SIMPLEREPORTTEST [(BITOR)]            0

  SIMPLEREPORTTEST [(BITOR  123   )]    123
  SIMPLEREPORTTEST [(BITOR -123   )]   -123

  SIMPLEREPORTTEST [(BITOR 5    2   )]  7
  SIMPLEREPORTTEST [(BITOR 5    1   )]  5
  SIMPLEREPORTTEST [(BITOR 0    0   )]  0
  SIMPLEREPORTTEST [(BITOR 5   -1   )] -1
  SIMPLEREPORTTEST [(BITOR 5.0  2.0 )]  7

  SIMPLEREPORTTEST [(BITOR 6 2 10)]     14

END

TO BITORTEST.BADINPUT

  ; first input is bad
  RUNBADINPUTTEST [(BITOR "word)]
  RUNBADINPUTTEST [(BITOR [123])]
  RUNBADINPUTTEST [(BITOR {123})]
  RUNBADINPUTTEST [(BITOR 12.30)]

  ; second input is bad
  RUNBADINPUTTEST [(BITOR 1 "word)]
  RUNBADINPUTTEST [(BITOR 1 [123])]
  RUNBADINPUTTEST [(BITOR 1 {123})]
  RUNBADINPUTTEST [(BITOR 1 12.30)]
END


TO BITXORTEST.SMOKETEST

  SIMPLEREPORTTEST [(BITXOR)]           0

  SIMPLEREPORTTEST [(BITXOR  123   )]  123
  SIMPLEREPORTTEST [(BITXOR -123   )] -123

  SIMPLEREPORTTEST [(BITXOR 5    2   )]  7
  SIMPLEREPORTTEST [(BITXOR 5    1   )]  4
  SIMPLEREPORTTEST [(BITXOR 0    0   )]  0
  SIMPLEREPORTTEST [(BITXOR 5   -1   )] -6
  SIMPLEREPORTTEST [(BITXOR 5    5   )]  0
  SIMPLEREPORTTEST [(BITXOR 5.0  1.0 )]  4

  SIMPLEREPORTTEST [(BITXOR 6  2 10)]    14

END

TO BITXORTEST.BADINPUT

  ; first input is bad
  RUNBADINPUTTEST [(BITXOR "word)]
  RUNBADINPUTTEST [(BITXOR [123])]
  RUNBADINPUTTEST [(BITXOR {123})]
  RUNBADINPUTTEST [(BITXOR 12.30)]

  ; second input is bad
  RUNBADINPUTTEST [(BITXOR 1 "word)]
  RUNBADINPUTTEST [(BITXOR 1 [123])]
  RUNBADINPUTTEST [(BITXOR 1 {123})]
  RUNBADINPUTTEST [(BITXOR 1 12.30)]
END

TO BITNOTTEST.SMOKETEST

  SIMPLEREPORTTEST [BITNOT  123  ] -124
  SIMPLEREPORTTEST [BITNOT -124  ]  123
  SIMPLEREPORTTEST [BITNOT    0  ] -1
  SIMPLEREPORTTEST [BITNOT 12.00 ] -13

END

TO BITNOTTEST.BADINPUT

  RUNNOTENOUGHINPUTSTEST [(BITNOT)]
  RUNTOOMANYINPUTSTEST   [(BITNOT 123 456)]

  RUNBADINPUTTEST        [BITNOT "word]
  RUNBADINPUTTEST        [BITNOT [123]]
  RUNBADINPUTTEST        [BITNOT {123}]
  RUNBADINPUTTEST        [BITNOT 12.30]
END


TO LSHIFTTEST.SMOKETEST

  SIMPLEREPORTTEST [LSHIFT   5    2    ]          20
  SIMPLEREPORTTEST [LSHIFT  20   -2    ]           5
  SIMPLEREPORTTEST [LSHIFT -20   -1    ]  2147483638
  SIMPLEREPORTTEST [LSHIFT   5    0    ]           5
  SIMPLEREPORTTEST [LSHIFT   0    5    ]           0
  SIMPLEREPORTTEST [ASHIFT   5.0  2.00 ]          20

END

TO LSHIFTTEST.BADINPUT

  RUNNOTENOUGHINPUTSTEST [(LSHIFT 5)]
  RUNTOOMANYINPUTSTEST   [(LSHIFT 5 0 "toomany)]

  ; bad first input
  RUNBADINPUTTEST [LSHIFT "word 0]
  RUNBADINPUTTEST [LSHIFT [123] 0]
  RUNBADINPUTTEST [LSHIFT {123} 0]
  RUNBADINPUTTEST [LSHIFT 12.30 0]

  ; bad second input
  RUNBADINPUTTEST [LSHIFT 5 "word]
  RUNBADINPUTTEST [LSHIFT 5 [123]]
  RUNBADINPUTTEST [LSHIFT 5 {123}]
  RUNBADINPUTTEST [LSHIFT 5 12.30]
END

TO ASHIFTTEST.SMOKETEST

  SIMPLEREPORTTEST [ASHIFT   5    2    ]  20
  SIMPLEREPORTTEST [ASHIFT  20   -2    ]   5
  SIMPLEREPORTTEST [ASHIFT -20   -1    ] -10
  SIMPLEREPORTTEST [ASHIFT   5    0    ]   5
  SIMPLEREPORTTEST [ASHIFT   0    5    ]   0
  SIMPLEREPORTTEST [ASHIFT   5.0  2.00 ]   20

END

TO ASHIFTTEST.BADINPUT

  RUNNOTENOUGHINPUTSTEST [(ASHIFT 5)]
  RUNTOOMANYINPUTSTEST   [(ASHIFT 5 0 "toomany)]

  ; bad first input
  RUNBADINPUTTEST [ASHIFT "word 0]
  RUNBADINPUTTEST [ASHIFT [123] 0]
  RUNBADINPUTTEST [ASHIFT {123} 0]
  RUNBADINPUTTEST [ASHIFT 12.30 0]

  ; bad second input
  RUNBADINPUTTEST [ASHIFT 5 "word]
  RUNBADINPUTTEST [ASHIFT 5 [123]]
  RUNBADINPUTTEST [ASHIFT 5 {123}]
  RUNBADINPUTTEST [ASHIFT 5 12.30]

END

TO BITWISETEST

  BITANDTEST.SMOKETEST
  BITANDTEST.BADINPUT

  BITORTEST.SMOKETEST
  BITORTEST.BADINPUT

  BITXORTEST.SMOKETEST
  BITXORTEST.BADINPUT

  BITNOTTEST.SMOKETEST
  BITNOTTEST.BADINPUT

  LSHIFTTEST.SMOKETEST
  LSHIFTTEST.BADINPUT

  ASHIFTTEST.SMOKETEST
  ASHIFTTEST.BADINPUT
END

