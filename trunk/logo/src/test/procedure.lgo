TO SAMPLEPROC  :a  :b
  PRINT :a ; print
  SHOW  :b ; show
END

TO PROCEDURETEST

  ; test TEXT
  SIMPLEREPORTTEST ~
    [TEXT "SAMPLEPROC] ~
    [[a b] [PRINT :a] [SHOW :b]]

  RUNBADINPUTTEST [(TEXT)]
  RUNBADINPUTTEST [(TEXT "nonexistent)]

  ; test FULLTEXT
  SIMPLEREPORTTEST ~
     [FULLTEXT "SAMPLEPROC] ~
     (LIST 
        "|TO SAMPLEPROC  :a  :b|
        "|  PRINT :a ; print| 
        "|  SHOW  :b ; show| 
        "END)

   RUNBADINPUTTEST [(FULLTEXT)]
   RUNBADINPUTTEST [(FULLTEXT "nonexistent)]

   ; test DEFINEDP
   SIMPLEREPORTTEST [DEFINEDP "nonexistent] "false
   SIMPLEREPORTTEST [DEFINED? "nonexistent] "false
   SIMPLEREPORTTEST [DEFINED? "FORWARD]     "false
   SIMPLEREPORTTEST [DEFINED? "SAMPLEPROC]  "true
   SIMPLEREPORTTEST [DEFINED? "sampleproc]  "true

   ; test PROCEDUREP
   SIMPLEREPORTTEST [PROCEDUREP "nonexistent] "false
   SIMPLEREPORTTEST [PROCEDURE? "nonexistent] "false
   SIMPLEREPORTTEST [PROCEDURE? "FORWARD]     "true
   SIMPLEREPORTTEST [PROCEDURE? "SAMPLEPROC]  "true
   SIMPLEREPORTTEST [PROCEDURE? "sampleproc]  "true

   ; test NAMEP
   LOCALMAKE "namepvariable 0
   SIMPLEREPORTTEST [NAMEP "nonexistent]   "false
   SIMPLEREPORTTEST [NAME? "nonexistent]   "false
   SIMPLEREPORTTEST [NAME? "FORWARD]       "false
   SIMPLEREPORTTEST [NAME? "namepvariable] "true
   SIMPLEREPORTTEST [NAME? "NAMEPVARIABLE] "true

   ; test PRIMITIVEP
   SIMPLEREPORTTEST [PRIMITIVEP "nonexistent]   "false
   SIMPLEREPORTTEST [PRIMITIVE? "nonexistent]   "false
   SIMPLEREPORTTEST [PRIMITIVE? "FORWARD]       "true
   SIMPLEREPORTTEST [PRIMITIVE? "FD]            "true
   SIMPLEREPORTTEST [PRIMITIVE? "namepvariable] "false
   SIMPLEREPORTTEST [PRIMITIVE? "sampleproc]    "false

   ; test DEFINE
   DEFINE "ECHO [[a] [output :a] ]
   SIMPLEREPORTTEST [ECHO "input] "input
   SIMPLEREPORTTEST [DEFINEDP "ECHO] "true
   SIMPLEREPORTTEST [DEFINED? "ECHO] "true
   RUNBADINPUTTEST [(DEFINE)]
   RUNBADINPUTTEST [(DEFINE "function)]
   RUNBADINPUTTEST [(DEFINE "function [])]

   ; Just exercise these functions
   ; we'll figure out how to test their output later
   IGNORE NAMES

   OPENWRITE "po.dump.txt
   LOCALMAKE "previouswriter WRITER
   SETWRITE "po.dump.txt
   PO CONTENTS
   SETWRITE :previouswriter
   CLOSE "po.dump.txt
   ERASEFILE "po.dump.txt

   RUNBADINPUTTEST [(PO)]
END

