LOAD "testlib.lgo


TO PENUPDOWNTEST
   LOCALMAKE "penwasdown PENDOWNP

   PENDOWN
   SIMPLEREPORTTEST [PENDOWNP]   "true
   SIMPLEREPORTTEST [PENDOWN?]   "true
   SIMPLEREPORTTEST [ITEM 1 PEN] "pendown

   PENUP
   SIMPLEREPORTTEST [PENDOWN?]   "false
   SIMPLEREPORTTEST [ITEM 1 PEN] "penup

   RUNBADINPUTTEST [(PENDOWN  "toomany)]
   RUNBADINPUTTEST [(PENUP    "toomany)]
   RUNBADINPUTTEST [(PENDOWN? "toomany)]

   ; undo side-effects
   IFELSE :penwasdown [ PENDOWN ] [ PENDUP ]
END

TO PENMODETEST

   LOCALMAKE "oldpenmode PENMODE
   LOCALMAKE "penwasdown PENDOWNP

   ; setting a new mode always puts the pen down

   PENUP
   PENPAINT
   SIMPLEREPORTTEST [PENMODE]    "paint
   SIMPLEREPORTTEST [ITEM 2 PEN] "paint
   SIMPLEREPORTTEST [PENDOWN?]   "true

   PENUP
   PENERASE
   SIMPLEREPORTTEST [PENMODE]    "erase
   SIMPLEREPORTTEST [ITEM 2 PEN] "erase
   SIMPLEREPORTTEST [PENDOWN?]   "true

   PENUP
   PENREVERSE
   SIMPLEREPORTTEST [PENMODE]    "reverse
   SIMPLEREPORTTEST [ITEM 2 PEN] "reverse
   SIMPLEREPORTTEST [PENDOWN?]   "true

   PENUP
   PPT
   SIMPLEREPORTTEST [PENMODE]    "paint
   SIMPLEREPORTTEST [ITEM 2 PEN] "paint
   SIMPLEREPORTTEST [PENDOWN?]   "true

   PENUP
   PE
   SIMPLEREPORTTEST [PENMODE]    "erase
   SIMPLEREPORTTEST [ITEM 2 PEN] "erase
   SIMPLEREPORTTEST [PENDOWN?]   "true

   PENUP
   PX
   SIMPLEREPORTTEST [PENMODE]    "reverse
   SIMPLEREPORTTEST [ITEM 2 PEN] "reverse
   SIMPLEREPORTTEST [PENDOWN?]   "true

   ; undo side-effects
   IFELSE :penwasdown [ PENDOWN ] [ PENDUP ]
   RUN    (list word "pen :oldpenmode)
END


TO PENTEST
  PENUPDOWNTEST
  PENMODETEST
END
