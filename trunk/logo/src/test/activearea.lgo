LOAD "testlib.lgo

TO ACTIVEAREATEST

   LOCALMAKE "oldactivearea ACTIVEAREA

   SETACTIVEAREA [-100 -100 100 100]
   SIMPLEREPORTTEST [ACTIVEAREA] [-100 -100 100 100]

   ; there is special code for the "default" active area
   SETACTIVEAREA [-500 -500 500 500]
   SIMPLEREPORTTEST [ACTIVEAREA] [-500 -500 500 500]

   ; floating point values are accepted (and truncated)
   SETACTIVEAREA [-500.67 -500.43 500.00 500.9999]
   SIMPLEREPORTTEST [ACTIVEAREA] [-500 -500 500 500]


   ; unexpected number of inputs
   RUNBADINPUTTEST [(SETACTIVEAREA)               ]
   RUNBADINPUTTEST [(SETACTIVAREA 0)              ]
   RUNBADINPUTTEST [(SETACTIVAREA 0 0)            ]
   RUNBADINPUTTEST [(SETACTIVAREA 0 0 50)         ]
   RUNBADINPUTTEST [(SETACTIVAREA 0 0 50 50)      ]

   ; wrong number of inputs for list
   RUNBADINPUTTEST [(SETACTIVAREA [0])            ]
   RUNBADINPUTTEST [(SETACTIVAREA [0 0])          ]
   RUNBADINPUTTEST [(SETACTIVAREA [0 0 50])       ]
   RUNBADINPUTTEST [(SETACTIVAREA [0 0 50 50 50]) ]

   ; bad parameters
   RUNBADINPUTTEST [SETACTIVAREA {0    0    50     50}]
   RUNBADINPUTTEST [SETACTIVAREA [zero 0    50     50]]
   RUNBADINPUTTEST [SETACTIVAREA [[0]  0    50     50]]
   RUNBADINPUTTEST [SETACTIVAREA [{0}  0    50     50]]
   RUNBADINPUTTEST [SETACTIVAREA [0   zero  50     50]]
   RUNBADINPUTTEST [SETACTIVAREA [0    [0]  50     50]]
   RUNBADINPUTTEST [SETACTIVAREA [0    {0}  50     50]]
   RUNBADINPUTTEST [SETACTIVAREA [0    0    fifty  50]]
   RUNBADINPUTTEST [SETACTIVAREA [0    0    [50]   50]]
   RUNBADINPUTTEST [SETACTIVAREA [0    0    {50}   50]]
   RUNBADINPUTTEST [SETACTIVAREA [0    0    50     fifty]]
   RUNBADINPUTTEST [SETACTIVAREA [0    0    50     [50]]]
   RUNBADINPUTTEST [SETACTIVAREA [0    0    50     {50}]]
   RUNBADINPUTTEST [SETACTIVAREA [0    0    50     {50}]]
       
   ; invalid ranges
   RUNBADINPUTTEST [SETACTIVAREA [0     0    -50     50]]
   RUNBADINPUTTEST [SETACTIVAREA [0     0     50    -50]]
   RUNBADINPUTTEST [SETACTIVAREA [0     0     50    -50]]
   RUNBADINPUTTEST [SETACTIVAREA [0     0     0      0]]

   RUNTOOMANYINPUTSTEST [(ACTIVAREA  "toomany)]

   ; undo side-effects
   SETACTIVEAREA :oldactivearea
END
